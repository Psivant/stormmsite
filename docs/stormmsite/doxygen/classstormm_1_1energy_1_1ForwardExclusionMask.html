<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STORMM Source Documentation: stormm::energy::ForwardExclusionMask Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">STORMM Source Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>stormm</b></li><li class="navelem"><b>energy</b></li><li class="navelem"><a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html">ForwardExclusionMask</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classstormm_1_1energy_1_1ForwardExclusionMask-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">stormm::energy::ForwardExclusionMask Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This exclusion mask relies on the reality that, in most topologies, the bulk of one atom's exclusions will be found within the next 32 atoms listed in the topology. If an atom excludes other atoms beyond this range, a separate index records the position at which this happens and provides either an index into a list of additional atoms or, if possible, the index of one other reference index in the topology followed by a second mask of 32 atoms which indicate exclusions relative to the reference index. To keep the list as compact as possible, the exclusion mask only considers "forward" exclusions, meaning excluded atoms with higher index than the one for which the mask is made. There is no double-counting: if atom 1 excludes atom 5, then atom 5 does not note an exclusion of atom 1.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="forward__exclusionmask_8h_source.html">forward_exclusionmask.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2b2478a43f8094568826dc0b2f11bf30" id="r_a2b2478a43f8094568826dc0b2f11bf30"><td class="memItemLeft" align="right" valign="top"><a id="a2b2478a43f8094568826dc0b2f11bf30" name="a2b2478a43f8094568826dc0b2f11bf30"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getAtomCount</b> () const</td></tr>
<tr class="memdesc:a2b2478a43f8094568826dc0b2f11bf30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of atoms in the system. <br /></td></tr>
<tr class="separator:a2b2478a43f8094568826dc0b2f11bf30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad51b8424a43fbc85120b2731ef22440c" id="r_ad51b8424a43fbc85120b2731ef22440c"><td class="memItemLeft" align="right" valign="top"><a id="ad51b8424a43fbc85120b2731ef22440c" name="ad51b8424a43fbc85120b2731ef22440c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getPrimaryMaskCount</b> () const</td></tr>
<tr class="memdesc:ad51b8424a43fbc85120b2731ef22440c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of unique primary masks that the system requires to store all of its non-bonded exclusions. <br /></td></tr>
<tr class="separator:ad51b8424a43fbc85120b2731ef22440c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaab986af20329b23537ec3abc062a777" id="r_aaab986af20329b23537ec3abc062a777"><td class="memItemLeft" align="right" valign="top"><a id="aaab986af20329b23537ec3abc062a777" name="aaab986af20329b23537ec3abc062a777"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getExtendedMaskCount</b> () const</td></tr>
<tr class="memdesc:aaab986af20329b23537ec3abc062a777"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of primary masks that involve a half-mask extension rather than a reference to a full list of additional secondary masks. <br /></td></tr>
<tr class="separator:aaab986af20329b23537ec3abc062a777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a960dbe665c2b102ad99f04f1ad87820c" id="r_a960dbe665c2b102ad99f04f1ad87820c"><td class="memItemLeft" align="right" valign="top"><a id="a960dbe665c2b102ad99f04f1ad87820c" name="a960dbe665c2b102ad99f04f1ad87820c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getSecondaryMaskCount</b> () const</td></tr>
<tr class="memdesc:a960dbe665c2b102ad99f04f1ad87820c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of secondary masks that the system requires to store all of its non-bonded exclusions. <br /></td></tr>
<tr class="separator:a960dbe665c2b102ad99f04f1ad87820c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af47b286820c1e9e4313b96e57e74dd1e" id="r_af47b286820c1e9e4313b96e57e74dd1e"><td class="memItemLeft" align="right" valign="top"><a id="af47b286820c1e9e4313b96e57e74dd1e" name="af47b286820c1e9e4313b96e57e74dd1e"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getTotalExclusionsCount</b> () const</td></tr>
<tr class="memdesc:af47b286820c1e9e4313b96e57e74dd1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the total number of exclusions by counting all the checked bits and accounting for excluded reference atoms. <br /></td></tr>
<tr class="separator:af47b286820c1e9e4313b96e57e74dd1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107a41047bae92b1805f6062f98bbc60" id="r_a107a41047bae92b1805f6062f98bbc60"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structstormm_1_1data__types_1_1uint2.html">uint2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a107a41047bae92b1805f6062f98bbc60">getPrimaryMask</a> (int index) const</td></tr>
<tr class="memdesc:a107a41047bae92b1805f6062f98bbc60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get an atom's primary mask.  <br /></td></tr>
<tr class="separator:a107a41047bae92b1805f6062f98bbc60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adddb53be318f307803ac1bde9bb04c21" id="r_adddb53be318f307803ac1bde9bb04c21"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structstormm_1_1data__types_1_1uint2.html">uint2</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adddb53be318f307803ac1bde9bb04c21">getSecondaryMasks</a> (int start, int length) const</td></tr>
<tr class="memdesc:adddb53be318f307803ac1bde9bb04c21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all secondary masks associated with an atom. Each presents the exclusions for a cluster of atoms following some reference atom.  <br /></td></tr>
<tr class="separator:adddb53be318f307803ac1bde9bb04c21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a384da9839d2bbbe880e1f532af7f8e69" id="r_a384da9839d2bbbe880e1f532af7f8e69"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structstormm_1_1energy_1_1ForwardExclusionMaskReader.html">ForwardExclusionMaskReader</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a384da9839d2bbbe880e1f532af7f8e69">data</a> (HybridTargetLevel tier=HybridTargetLevel::HOST) const</td></tr>
<tr class="memdesc:a384da9839d2bbbe880e1f532af7f8e69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the collection of this object's pointers and critical constants.  <br /></td></tr>
<tr class="separator:a384da9839d2bbbe880e1f532af7f8e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1921c45dd62d6b1972eb50c5e241870b" id="r_a1921c45dd62d6b1972eb50c5e241870b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1921c45dd62d6b1972eb50c5e241870b">testExclusion</a> (int atom_i, int atom_j) const</td></tr>
<tr class="memdesc:a1921c45dd62d6b1972eb50c5e241870b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether a pair of atoms is an exclusion or not.  <br /></td></tr>
<tr class="separator:a1921c45dd62d6b1972eb50c5e241870b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a793c6a80cf1fbdc511de6fdaa17052d0" id="r_a793c6a80cf1fbdc511de6fdaa17052d0"><td class="memItemLeft" align="right" valign="top"><a id="a793c6a80cf1fbdc511de6fdaa17052d0" name="a793c6a80cf1fbdc511de6fdaa17052d0"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ForwardExclusionMask</b> (const <a class="el" href="classstormm_1_1topology_1_1AtomGraph.html">AtomGraph</a> *ag_in=nullptr)</td></tr>
<tr class="memdesc:a793c6a80cf1fbdc511de6fdaa17052d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor requires a topology and creates a blank object if given nullptr. <br /></td></tr>
<tr class="separator:a793c6a80cf1fbdc511de6fdaa17052d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88a65af19af27d6e9f6e893139be3529" id="r_a88a65af19af27d6e9f6e893139be3529"><td class="memItemLeft" align="right" valign="top"><a id="a88a65af19af27d6e9f6e893139be3529" name="a88a65af19af27d6e9f6e893139be3529"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ForwardExclusionMask</b> (const <a class="el" href="classstormm_1_1topology_1_1AtomGraph.html">AtomGraph</a> &amp;ag_in)</td></tr>
<tr class="separator:a88a65af19af27d6e9f6e893139be3529"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:ab150e5bb9d888a71728cebdd0a980277" id="r_ab150e5bb9d888a71728cebdd0a980277"><td class="memItemLeft" align="right" valign="top"><a id="ab150e5bb9d888a71728cebdd0a980277" name="ab150e5bb9d888a71728cebdd0a980277"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ForwardExclusionMask</b> (const <a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html">ForwardExclusionMask</a> &amp;original)=default</td></tr>
<tr class="memdesc:ab150e5bb9d888a71728cebdd0a980277"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default copy and move constructors as well as the copy and move assignment operator will suffice for this object, which has no POINTER-kind <a class="el" href="classstormm_1_1energy_1_1Hybrid.html" title="An evolution of GpuBuffer in pmemd.cuda, the Composite array has elements that are accessible from ei...">Hybrid</a> objects among its members. <br /></td></tr>
<tr class="separator:ab150e5bb9d888a71728cebdd0a980277"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a147d0e9aa59bc8713056657d19e7b2b9" id="r_a147d0e9aa59bc8713056657d19e7b2b9"><td class="memItemLeft" align="right" valign="top"><a id="a147d0e9aa59bc8713056657d19e7b2b9" name="a147d0e9aa59bc8713056657d19e7b2b9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ForwardExclusionMask</b> (<a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html">ForwardExclusionMask</a> &amp;&amp;original)=default</td></tr>
<tr class="separator:a147d0e9aa59bc8713056657d19e7b2b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab695372b1b662787ebb127d538438097" id="r_ab695372b1b662787ebb127d538438097"><td class="memItemLeft" align="right" valign="top"><a id="ab695372b1b662787ebb127d538438097" name="ab695372b1b662787ebb127d538438097"></a>
<a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html">ForwardExclusionMask</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html">ForwardExclusionMask</a> &amp;other)=default</td></tr>
<tr class="separator:ab695372b1b662787ebb127d538438097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaef5e5971a70ae62c8cb055029efcae7" id="r_aaef5e5971a70ae62c8cb055029efcae7"><td class="memItemLeft" align="right" valign="top"><a id="aaef5e5971a70ae62c8cb055029efcae7" name="aaef5e5971a70ae62c8cb055029efcae7"></a>
<a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html">ForwardExclusionMask</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html">ForwardExclusionMask</a> &amp;&amp;other)=default</td></tr>
<tr class="separator:aaef5e5971a70ae62c8cb055029efcae7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This exclusion mask relies on the reality that, in most topologies, the bulk of one atom's exclusions will be found within the next 32 atoms listed in the topology. If an atom excludes other atoms beyond this range, a separate index records the position at which this happens and provides either an index into a list of additional atoms or, if possible, the index of one other reference index in the topology followed by a second mask of 32 atoms which indicate exclusions relative to the reference index. To keep the list as compact as possible, the exclusion mask only considers "forward" exclusions, meaning excluded atoms with higher index than the one for which the mask is made. There is no double-counting: if atom 1 excludes atom 5, then atom 5 does not note an exclusion of atom 1. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a384da9839d2bbbe880e1f532af7f8e69" name="a384da9839d2bbbe880e1f532af7f8e69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a384da9839d2bbbe880e1f532af7f8e69">&#9670;&#160;</a></span>data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structstormm_1_1energy_1_1ForwardExclusionMaskReader.html">ForwardExclusionMaskReader</a> stormm::energy::ForwardExclusionMask::data </td>
          <td>(</td>
          <td class="paramtype">HybridTargetLevel</td>          <td class="paramname"><span class="paramname"><em>tier</em></span><span class="paramdefsep"> = </span><span class="paramdefval">HybridTargetLevel::HOST</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the collection of this object's pointers and critical constants. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tier</td><td>Level at which to get the data pointers (host CPU or GPU device) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a107a41047bae92b1805f6062f98bbc60" name="a107a41047bae92b1805f6062f98bbc60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a107a41047bae92b1805f6062f98bbc60">&#9670;&#160;</a></span>getPrimaryMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structstormm_1_1data__types_1_1uint2.html">uint2</a> stormm::energy::ForwardExclusionMask::getPrimaryMask </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>index</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get an atom's primary mask. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>Topological index of the atom of interest </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adddb53be318f307803ac1bde9bb04c21" name="adddb53be318f307803ac1bde9bb04c21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adddb53be318f307803ac1bde9bb04c21">&#9670;&#160;</a></span>getSecondaryMasks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structstormm_1_1data__types_1_1uint2.html">uint2</a> &gt; stormm::energy::ForwardExclusionMask::getSecondaryMasks </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>length</em></span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get all secondary masks associated with an atom. Each presents the exclusions for a cluster of atoms following some reference atom. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start</td><td>The index of the first secondary mask to read </td></tr>
    <tr><td class="paramname">length</td><td>The number of secondary masks to read </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1921c45dd62d6b1972eb50c5e241870b" name="a1921c45dd62d6b1972eb50c5e241870b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1921c45dd62d6b1972eb50c5e241870b">&#9670;&#160;</a></span>testExclusion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool stormm::energy::ForwardExclusionMask::testExclusion </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>atom_i</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>atom_j</em></span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test whether a pair of atoms is an exclusion or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">atom_i</td><td>The first atom </td></tr>
    <tr><td class="paramname">atom_j</td><td>The second atom (if atom_j &lt; atom_i, the function will make a recursive call with atom_i and atom_j reversed) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/Potential/<a class="el" href="forward__exclusionmask_8h_source.html">forward_exclusionmask.h</a></li>
<li>src/Potential/<b>forward_exclusionmask.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
