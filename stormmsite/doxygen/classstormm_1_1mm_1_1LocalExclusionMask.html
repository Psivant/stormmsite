<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STORMM Source Documentation: stormm::mm::LocalExclusionMask Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">STORMM Source Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>stormm</b></li><li class="navelem"><b>mm</b></li><li class="navelem"><a class="el" href="classstormm_1_1mm_1_1LocalExclusionMask.html">LocalExclusionMask</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classstormm_1_1mm_1_1LocalExclusionMask-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">stormm::mm::LocalExclusionMask Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The local exclusion mask is an generalized form of the <a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html" title="This exclusion mask relies on the reality that, in most topologies, the bulk of one atom&#39;s exclusions...">ForwardExclusionMask</a>, listing all exclusions in various ranges of an atom followed by additional masks. Like the <a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html" title="This exclusion mask relies on the reality that, in most topologies, the bulk of one atom&#39;s exclusions...">ForwardExclusionMask</a>, all atoms are assigned an index, but it points to a primary array of profiles, not quite like the primary masks of the ForwardExclusionList. There are a finite number of profiles, each containing a three-bit code to indicate how it is to be used.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="local__exclusionmask_8h_source.html">local_exclusionmask.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a10e83e8ddb541be5391a7d9eb396a13c" id="r_a10e83e8ddb541be5391a7d9eb396a13c"><td class="memItemLeft" align="right" valign="top"><a id="a10e83e8ddb541be5391a7d9eb396a13c" name="a10e83e8ddb541be5391a7d9eb396a13c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getAtomCount</b> () const</td></tr>
<tr class="memdesc:a10e83e8ddb541be5391a7d9eb396a13c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of atoms in the system. <br /></td></tr>
<tr class="separator:a10e83e8ddb541be5391a7d9eb396a13c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f95ccd55532bd29e682e0b850c9a4a7" id="r_a9f95ccd55532bd29e682e0b850c9a4a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f95ccd55532bd29e682e0b850c9a4a7">getMode</a> (int atom_index, int system_index=0) const</td></tr>
<tr class="memdesc:a9f95ccd55532bd29e682e0b850c9a4a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the profile mode used by a particular atom as a positive integer.  <br /></td></tr>
<tr class="separator:a9f95ccd55532bd29e682e0b850c9a4a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14224cebf6566fde823e6139d79a2625" id="r_a14224cebf6566fde823e6139d79a2625"><td class="memItemLeft" align="right" valign="top"><a id="a14224cebf6566fde823e6139d79a2625" name="a14224cebf6566fde823e6139d79a2625"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>getSecondaryMaskCount</b> () const</td></tr>
<tr class="memdesc:a14224cebf6566fde823e6139d79a2625"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of secondary masks. <br /></td></tr>
<tr class="separator:a14224cebf6566fde823e6139d79a2625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fd5994d3b9b93491f3fd696509a8e02" id="r_a4fd5994d3b9b93491f3fd696509a8e02"><td class="memItemLeft" align="right" valign="top">ullint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4fd5994d3b9b93491f3fd696509a8e02">getProfile</a> (int atom_index, int system_index=0) const</td></tr>
<tr class="memdesc:a4fd5994d3b9b93491f3fd696509a8e02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the exclusion profile for an atom.  <br /></td></tr>
<tr class="separator:a4fd5994d3b9b93491f3fd696509a8e02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ab18e175fb3f8659ba8ec1862e02ec8" id="r_a3ab18e175fb3f8659ba8ec1862e02ec8"><td class="memItemLeft" align="right" valign="top"><a id="a3ab18e175fb3f8659ba8ec1862e02ec8" name="a3ab18e175fb3f8659ba8ec1862e02ec8"></a>
const <a class="el" href="classstormm_1_1card_1_1Hybrid.html">Hybrid</a>&lt; <a class="el" href="structstormm_1_1data__types_1_1uint2.html">uint2</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>getSecondaryMaskView</b> (int atom_index, int system_index=0)</td></tr>
<tr class="memdesc:a3ab18e175fb3f8659ba8ec1862e02ec8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a POINTER-kind <a class="el" href="classstormm_1_1mm_1_1Hybrid.html" title="An evolution of GpuBuffer in pmemd.cuda, the Composite array has elements that are accessible from ei...">Hybrid</a> object for viewing all secondary masks associated with an atom. Each presents the exclusions for a cluster of atoms following some reference atom. Descriptions of parameters follow from <a class="el" href="classstormm_1_1energy_1_1LocalExclusionMask.html#a4fd5994d3b9b93491f3fd696509a8e02" title="Get the exclusion profile for an atom.">getProfile()</a> above. <br /></td></tr>
<tr class="separator:a3ab18e175fb3f8659ba8ec1862e02ec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2365fa8ab65e8765b6507ba1821c066f" id="r_a2365fa8ab65e8765b6507ba1821c066f"><td class="memItemLeft" align="right" valign="top"><a id="a2365fa8ab65e8765b6507ba1821c066f" name="a2365fa8ab65e8765b6507ba1821c066f"></a>
const <a class="el" href="classstormm_1_1topology_1_1AtomGraph.html">AtomGraph</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>getTopologyPointer</b> () const</td></tr>
<tr class="memdesc:a2365fa8ab65e8765b6507ba1821c066f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a pointer to the topology associated with this object. <br /></td></tr>
<tr class="separator:a2365fa8ab65e8765b6507ba1821c066f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36490b338bda41aa42f9668ea0974d6d" id="r_a36490b338bda41aa42f9668ea0974d6d"><td class="memItemLeft" align="right" valign="top"><a id="a36490b338bda41aa42f9668ea0974d6d" name="a36490b338bda41aa42f9668ea0974d6d"></a>
const <a class="el" href="classstormm_1_1synthesis_1_1AtomGraphSynthesis.html">AtomGraphSynthesis</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>getTopologySynthesisPointer</b> () const</td></tr>
<tr class="memdesc:a36490b338bda41aa42f9668ea0974d6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a pointer to the topology synthesis associated with this object. <br /></td></tr>
<tr class="separator:a36490b338bda41aa42f9668ea0974d6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af658ee85f5cf441fa98de1726ab5d2" id="r_a0af658ee85f5cf441fa98de1726ab5d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structstormm_1_1energy_1_1LocalExclusionMaskReader.html">LocalExclusionMaskReader</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0af658ee85f5cf441fa98de1726ab5d2">data</a> (HybridTargetLevel tier=HybridTargetLevel::HOST) const</td></tr>
<tr class="memdesc:a0af658ee85f5cf441fa98de1726ab5d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the abstract for the object.  <br /></td></tr>
<tr class="separator:a0af658ee85f5cf441fa98de1726ab5d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a8d0f2671e1cb6085af021a8522a37cf8" id="r_a8d0f2671e1cb6085af021a8522a37cf8"><td class="memItemLeft" align="right" valign="top"><a id="a8d0f2671e1cb6085af021a8522a37cf8" name="a8d0f2671e1cb6085af021a8522a37cf8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>LocalExclusionMask</b> (const <a class="el" href="classstormm_1_1topology_1_1AtomGraph.html">AtomGraph</a> *ag_in=nullptr, NonbondedTheme theme_in=NonbondedTheme::ALL)</td></tr>
<tr class="memdesc:a8d0f2671e1cb6085af021a8522a37cf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor requires a topology, and creates a blank object if nullptr is supplied. <br /></td></tr>
<tr class="separator:a8d0f2671e1cb6085af021a8522a37cf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939f3de3c46f25f215e91ea4b78ceb90" id="r_a939f3de3c46f25f215e91ea4b78ceb90"><td class="memItemLeft" align="right" valign="top"><a id="a939f3de3c46f25f215e91ea4b78ceb90" name="a939f3de3c46f25f215e91ea4b78ceb90"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>LocalExclusionMask</b> (const <a class="el" href="classstormm_1_1topology_1_1AtomGraph.html">AtomGraph</a> &amp;ag_in, NonbondedTheme theme_in=NonbondedTheme::ALL)</td></tr>
<tr class="separator:a939f3de3c46f25f215e91ea4b78ceb90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3b062df71825d974a299167c8a1970a" id="r_af3b062df71825d974a299167c8a1970a"><td class="memItemLeft" align="right" valign="top"><a id="af3b062df71825d974a299167c8a1970a" name="af3b062df71825d974a299167c8a1970a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>LocalExclusionMask</b> (const <a class="el" href="classstormm_1_1synthesis_1_1AtomGraphSynthesis.html">AtomGraphSynthesis</a> *poly_ag_in, NonbondedTheme theme_in=NonbondedTheme::ALL)</td></tr>
<tr class="separator:af3b062df71825d974a299167c8a1970a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad187ed2d7b80c92c91fdf317af2d0d4c" id="r_ad187ed2d7b80c92c91fdf317af2d0d4c"><td class="memItemLeft" align="right" valign="top"><a id="ad187ed2d7b80c92c91fdf317af2d0d4c" name="ad187ed2d7b80c92c91fdf317af2d0d4c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>LocalExclusionMask</b> (const <a class="el" href="classstormm_1_1synthesis_1_1AtomGraphSynthesis.html">AtomGraphSynthesis</a> &amp;poly_ag_in, NonbondedTheme theme_in=NonbondedTheme::ALL)</td></tr>
<tr class="separator:ad187ed2d7b80c92c91fdf317af2d0d4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a0a55afd147e3bec1425fbf527cab8cac" id="r_a0a55afd147e3bec1425fbf527cab8cac"><td class="memItemLeft" align="right" valign="top"><a id="a0a55afd147e3bec1425fbf527cab8cac" name="a0a55afd147e3bec1425fbf527cab8cac"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>LocalExclusionMask</b> (const <a class="el" href="classstormm_1_1energy_1_1LocalExclusionMask.html">LocalExclusionMask</a> &amp;original)=default</td></tr>
<tr class="memdesc:a0a55afd147e3bec1425fbf527cab8cac"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default copy and move constructors as well as the copy and move assignment operator will suffice for this object, which has no POINTER-kind <a class="el" href="classstormm_1_1mm_1_1Hybrid.html" title="An evolution of GpuBuffer in pmemd.cuda, the Composite array has elements that are accessible from ei...">Hybrid</a> objects among its members. <br /></td></tr>
<tr class="separator:a0a55afd147e3bec1425fbf527cab8cac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b60b8d04bcc1d5337d22134ee0a4e2f" id="r_a6b60b8d04bcc1d5337d22134ee0a4e2f"><td class="memItemLeft" align="right" valign="top"><a id="a6b60b8d04bcc1d5337d22134ee0a4e2f" name="a6b60b8d04bcc1d5337d22134ee0a4e2f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>LocalExclusionMask</b> (<a class="el" href="classstormm_1_1energy_1_1LocalExclusionMask.html">LocalExclusionMask</a> &amp;&amp;original)=default</td></tr>
<tr class="separator:a6b60b8d04bcc1d5337d22134ee0a4e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6faa34b88815d1e55f687233752e613a" id="r_a6faa34b88815d1e55f687233752e613a"><td class="memItemLeft" align="right" valign="top"><a id="a6faa34b88815d1e55f687233752e613a" name="a6faa34b88815d1e55f687233752e613a"></a>
<a class="el" href="classstormm_1_1energy_1_1LocalExclusionMask.html">LocalExclusionMask</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classstormm_1_1energy_1_1LocalExclusionMask.html">LocalExclusionMask</a> &amp;other)=default</td></tr>
<tr class="separator:a6faa34b88815d1e55f687233752e613a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95135f137e14785b99956b58db5087cd" id="r_a95135f137e14785b99956b58db5087cd"><td class="memItemLeft" align="right" valign="top"><a id="a95135f137e14785b99956b58db5087cd" name="a95135f137e14785b99956b58db5087cd"></a>
<a class="el" href="classstormm_1_1energy_1_1LocalExclusionMask.html">LocalExclusionMask</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="classstormm_1_1energy_1_1LocalExclusionMask.html">LocalExclusionMask</a> &amp;&amp;other)=default</td></tr>
<tr class="separator:a95135f137e14785b99956b58db5087cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a197da63e7a76fe6dfd27e8c7c6300f54" id="r_a197da63e7a76fe6dfd27e8c7c6300f54"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a197da63e7a76fe6dfd27e8c7c6300f54">getProfileCount</a> () const</td></tr>
<tr class="memdesc:a197da63e7a76fe6dfd27e8c7c6300f54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of unique profiles.  <br /></td></tr>
<tr class="separator:a197da63e7a76fe6dfd27e8c7c6300f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba2d72c1ae1e2649f552883aef9b5d0d" id="r_aba2d72c1ae1e2649f552883aef9b5d0d"><td class="memItemLeft" align="right" valign="top"><a id="aba2d72c1ae1e2649f552883aef9b5d0d" name="aba2d72c1ae1e2649f552883aef9b5d0d"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getProfileCount</b> (int mode_index) const</td></tr>
<tr class="separator:aba2d72c1ae1e2649f552883aef9b5d0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:ab117f976a1ab4a4e977232ceb0d91901" id="r_ab117f976a1ab4a4e977232ceb0d91901"><td class="memItemLeft" align="right" valign="top"><a id="ab117f976a1ab4a4e977232ceb0d91901" name="ab117f976a1ab4a4e977232ceb0d91901"></a>
std::vector&lt; <a class="el" href="structstormm_1_1data__types_1_1uint2.html">uint2</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>getSecondaryMasks</b> (int atom_index, int system_index=0) const</td></tr>
<tr class="memdesc:ab117f976a1ab4a4e977232ceb0d91901"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a copy of all secondary masks associated with an atom. Descriptions of parameters follow from <a class="el" href="classstormm_1_1energy_1_1LocalExclusionMask.html#a4fd5994d3b9b93491f3fd696509a8e02" title="Get the exclusion profile for an atom.">getProfile()</a> above. <br /></td></tr>
<tr class="separator:ab117f976a1ab4a4e977232ceb0d91901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a6704a8b1719087b7bc96a2c00049408f" id="r_a6704a8b1719087b7bc96a2c00049408f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6704a8b1719087b7bc96a2c00049408f">testExclusion</a> (int atom_i, int atom_j) const</td></tr>
<tr class="memdesc:a6704a8b1719087b7bc96a2c00049408f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return TRUE if two atoms in the same molecular system share an excluded interaction and FALSE if they interact according to the standard potential.  <br /></td></tr>
<tr class="separator:a6704a8b1719087b7bc96a2c00049408f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ca6eaf270871e003bb8e1903af874a4" id="r_a4ca6eaf270871e003bb8e1903af874a4"><td class="memItemLeft" align="right" valign="top"><a id="a4ca6eaf270871e003bb8e1903af874a4" name="a4ca6eaf270871e003bb8e1903af874a4"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>testExclusion</b> (int atom_i, int atom_j, int system_index) const</td></tr>
<tr class="separator:a4ca6eaf270871e003bb8e1903af874a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a8452219521484a26322078b23c6890a3" id="r_a8452219521484a26322078b23c6890a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8452219521484a26322078b23c6890a3">setTopology</a> (const <a class="el" href="classstormm_1_1topology_1_1AtomGraph.html">AtomGraph</a> *ag_in)</td></tr>
<tr class="memdesc:a8452219521484a26322078b23c6890a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set (or reset) the topology for the object. All exclusion masks and profiles will be rebuilt if the topology changes.  <br /></td></tr>
<tr class="separator:a8452219521484a26322078b23c6890a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade2e5233e315d7293cdb855b40fa19a6" id="r_ade2e5233e315d7293cdb855b40fa19a6"><td class="memItemLeft" align="right" valign="top"><a id="ade2e5233e315d7293cdb855b40fa19a6" name="ade2e5233e315d7293cdb855b40fa19a6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setTopology</b> (const <a class="el" href="classstormm_1_1topology_1_1AtomGraph.html">AtomGraph</a> &amp;ag_in)</td></tr>
<tr class="separator:ade2e5233e315d7293cdb855b40fa19a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af162b184b75c137fb140b637ccc0701b" id="r_af162b184b75c137fb140b637ccc0701b"><td class="memItemLeft" align="right" valign="top"><a id="af162b184b75c137fb140b637ccc0701b" name="af162b184b75c137fb140b637ccc0701b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setTopology</b> (const <a class="el" href="classstormm_1_1synthesis_1_1AtomGraphSynthesis.html">AtomGraphSynthesis</a> *poly_ag_in)</td></tr>
<tr class="separator:af162b184b75c137fb140b637ccc0701b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a4fd29e53887926679e240e76e5e5f4" id="r_a0a4fd29e53887926679e240e76e5e5f4"><td class="memItemLeft" align="right" valign="top"><a id="a0a4fd29e53887926679e240e76e5e5f4" name="a0a4fd29e53887926679e240e76e5e5f4"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setTopology</b> (const <a class="el" href="classstormm_1_1synthesis_1_1AtomGraphSynthesis.html">AtomGraphSynthesis</a> &amp;poly_ag_in)</td></tr>
<tr class="separator:a0a4fd29e53887926679e240e76e5e5f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The local exclusion mask is an generalized form of the <a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html" title="This exclusion mask relies on the reality that, in most topologies, the bulk of one atom&#39;s exclusions...">ForwardExclusionMask</a>, listing all exclusions in various ranges of an atom followed by additional masks. Like the <a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html" title="This exclusion mask relies on the reality that, in most topologies, the bulk of one atom&#39;s exclusions...">ForwardExclusionMask</a>, all atoms are assigned an index, but it points to a primary array of profiles, not quite like the primary masks of the ForwardExclusionList. There are a finite number of profiles, each containing a three-bit code to indicate how it is to be used. </p>
<p>When accessed, the profile is a 64-bit unsigned long long int, with several modes of operation indicated by its high three bits. For the purposes of the following discussion, we will take atom (i) of the topology (or the atom with absolute index (i) out of a synthesis of topologies) to access profile (j) and possibly secondary masks (k1) through (kN) when determining the existence of an excluded interaction with some other atom (m).</p>
<p>The first mode is the simplest, and covers nearly all situations that will be found in a typical MD simulation. The low 61 bits describe a mask such that the 31st bit, always 0, is the exclusion of the atom itself. Bits 1-30 indicate exclusions for atoms 30, 29, ..., 2, 1 topological position prior to the atom of interest (i). Bits 32-61 indicate exclusions for atoms 1, 2, ..., 29, 30 positions after atom (i). After retrieving the profile, the existence of an exclusion between (i) and some other atom (m) is computed by:</p>
<p>int del_im = (m) - (i); const bool excluded = (abs(del_im) &lt; 31 &amp;&amp; (((profile of i) &gt;&gt; (30 + del_im)) &amp; 0x1));</p>
<p>Mode A: 000 ---------------------------&mdash; 1 ---------------------------&mdash;</p>
<p>The mode of an atom with no exclusions, whether a monatomic ion or a water oxygen in the context of a van-der Waals pairlist, is also mode A: every atom excludes itself.</p>
<p>In the second mode, when the 62nd bit is set to one, the 31 bits are used in much the same way as the low 61 bits of the profile in Mode A. However, the next higher 10 bits indicate a patch of exclusions offset by -(NNNNN + 15) from atom (i) and the next higher 10 bits a similar patch of exclusions offset +(PPPPP + 15) atom (i). The code for evaluating exclusions is somewhat more involved but these types of masks will be rare.</p>
<p>Mode B: 001 PPPPP NNNNN -------&mdash; -------&mdash; ------------&mdash; 1 ------------&mdash;</p>
<p>In the diagram above, NNNNN and PPPPP are unsigned integers extracted from bits 55-57 and 58-60, respectively, and one bit is left unused. This more complex footprint, which can accommodate atoms with exclusions up to 56 topological indices away from the home atom, can be easily evaluated in most modes, if the difference between (i) and (m) is greater than 56.</p>
<p>In the third mode of operation, the 63rd bit of the profile is set to 1. The low 31 bits of the profile continue to function as before, but the next 14 represent a mask that is shifted relative to the original atom by -32768 to +32767 indices, as indicated by the high group of 16 bits just below the three mode bits (read the S bits below as an unsigned integer in the range [0, 65536) and subtract 32768). This is effective for the largest known proteins with disulfide bridges connecting one end of the chain to another.</p>
<p>Mode C: 010 SSSSSSSSSSSSSSSS -----------&mdash; ------------&mdash; 1 ------------&mdash;</p>
<p>In the fourth mode of operation, the 64th bit of the profile is set to 1. In this mode, the low 31 bits continue to function as they did in modes A and B, but the next 23 bits indicate an lower bound index into a secondary array, much as in the <a class="el" href="classstormm_1_1energy_1_1ForwardExclusionMask.html" title="This exclusion mask relies on the reality that, in most topologies, the bulk of one atom&#39;s exclusions...">ForwardExclusionMask</a> mode, where additional groups of exclusions are to be found. The highest 7 bits just behind the mode bits are taken as an unsigned integer indicating an upper bound, the number of consecutive indices to access from within the secondary array. The secondary array is a collection of unsigned int pairs, the "x" member being another local exclusion mask and the "y" member being a shift relative to the original atom. This mode would only be activated when there are extreme numbers of far-flung and non-contiguous exclusions for a single atom.</p>
<p>Mode D: 011 KKKKKKK IIIIIIIIIIIIIIIIIIIIIIII ------------&mdash; 1 ------------&mdash;</p>
<p>In the sixth mode of operation, the 62nd and 64th bits of the profile are set to 1. The profile itself no longer provides local exclusion masks. Instead, the low 40 bits operate as the index into the array of secondary masks while the higher 21 bits (those just behind the mode bits) provide the upper bound on the number of masks from the secondary array to access. Any system operating in this mode would have to contain exclusions of extreme complexity and the amount of available computer memory would become an issue before the format is broken. It could also be inefficient if taken to the extreme, where every atom has a large and far-flung but unique exclusions profile. Still, many thousands of atoms could be accommodated in this manner.</p>
<p>Mode E: 100 KKKKKKKKKKKKKKKKKKKKKK IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII</p>
<p>The final mode is applied when only a few atoms' exclusions (up to 32) are so astoundingly complex that it is easier to simply enumerate them for all atoms of the system (or group of systems) and perform a non-caching read of the pre-tabulated lists. This is not expected to occur in any ordinary MD simulation. The five lowest bits of the profile indicate the index of the pre-tabulated list to take in this mode.</p>
<p>Mode F: 101 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX IIIII</p>
<p>One final mode may be useful, but the list is quite thorough. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a0af658ee85f5cf441fa98de1726ab5d2" name="a0af658ee85f5cf441fa98de1726ab5d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0af658ee85f5cf441fa98de1726ab5d2">&#9670;&#160;</a></span>data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structstormm_1_1energy_1_1LocalExclusionMaskReader.html">LocalExclusionMaskReader</a> stormm::energy::LocalExclusionMask::data </td>
          <td>(</td>
          <td class="paramtype">HybridTargetLevel</td>          <td class="paramname"><span class="paramname"><em>tier</em></span><span class="paramdefsep"> = </span><span class="paramdefval">HybridTargetLevel::HOST</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the abstract for the object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tier</td><td>Indicate whether to target pointers to memory on the CPU host or GPU device </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9f95ccd55532bd29e682e0b850c9a4a7" name="a9f95ccd55532bd29e682e0b850c9a4a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f95ccd55532bd29e682e0b850c9a4a7">&#9670;&#160;</a></span>getMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stormm::energy::LocalExclusionMask::getMode </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>atom_index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>system_index</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the profile mode used by a particular atom as a positive integer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">atom_index</td><td>Index of the atom of interest </td></tr>
    <tr><td class="paramname">system_index</td><td>Index of the system of interest (applicable for topology syntheses) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4fd5994d3b9b93491f3fd696509a8e02" name="a4fd5994d3b9b93491f3fd696509a8e02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fd5994d3b9b93491f3fd696509a8e02">&#9670;&#160;</a></span>getProfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ullint stormm::energy::LocalExclusionMask::getProfile </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>atom_index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>system_index</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the exclusion profile for an atom. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">atom_index</td><td>Topological index of the atom of interest </td></tr>
    <tr><td class="paramname">system_index</td><td>Index of the system of interest (applicable for topology syntheses) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a197da63e7a76fe6dfd27e8c7c6300f54" name="a197da63e7a76fe6dfd27e8c7c6300f54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a197da63e7a76fe6dfd27e8c7c6300f54">&#9670;&#160;</a></span>getProfileCount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stormm::energy::LocalExclusionMask::getProfileCount </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the number of unique profiles. </p>
<p>Overloaded:</p><ul>
<li>Get the total number of profiles</li>
<li>Get the number of profiles using a particular mode</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mode_index</td><td>The index number of the mode of operation for the profile </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8452219521484a26322078b23c6890a3" name="a8452219521484a26322078b23c6890a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8452219521484a26322078b23c6890a3">&#9670;&#160;</a></span>setTopology()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stormm::energy::LocalExclusionMask::setTopology </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classstormm_1_1topology_1_1AtomGraph.html">AtomGraph</a> *</td>          <td class="paramname"><span class="paramname"><em>ag_in</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set (or reset) the topology for the object. All exclusion masks and profiles will be rebuilt if the topology changes. </p>
<p>Overloaded:</p><ul>
<li>Provide a single topology by pointer or const reference</li>
<li>Provide a synthesis of topologies by pointer or const reference</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ag_in</td><td>The new topology to set </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6704a8b1719087b7bc96a2c00049408f" name="a6704a8b1719087b7bc96a2c00049408f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6704a8b1719087b7bc96a2c00049408f">&#9670;&#160;</a></span>testExclusion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool stormm::energy::LocalExclusionMask::testExclusion </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>atom_i</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>atom_j</em></span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return TRUE if two atoms in the same molecular system share an excluded interaction and FALSE if they interact according to the standard potential. </p>
<p>Overloaded:</p><ul>
<li>Provide two atom indices to test the exclusion of two atoms in a single topology</li>
<li>Provide the system index in order to test the exclusion of two atoms in one system out of a synthesis</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">atom_i</td><td>Index of the first atom within the topology of interest </td></tr>
    <tr><td class="paramname">atom_j</td><td>Index of the second atom within the topology of interest </td></tr>
    <tr><td class="paramname">system_index</td><td>The system of interest (valid only for objects built on a topology synthesis) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/Potential/<a class="el" href="local__exclusionmask_8h_source.html">local_exclusionmask.h</a></li>
<li>src/Potential/<b>local_exclusionmask.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
